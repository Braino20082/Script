-- Roblox Unsichtbarkeits GUI

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

-- GUI Erstellen
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "UnsichtbarGUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.IgnoreGuiInset = true
ScreenGui.Parent = player:WaitForChild("PlayerGui")

-- Main Frame (Skalierbar)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.BorderSizePixel = 2
MainFrame.BorderColor3 = Color3.fromRGB(60, 60, 60)
MainFrame.Position = UDim2.new(0.35, 0, 0.35, 0)
MainFrame.Size = UDim2.new(0, 320, 0, 200)
MainFrame.Active = true
MainFrame.Draggable = true

-- UICorner f√ºr abgerundete Ecken
local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 8)
MainCorner.Parent = MainFrame

-- Title Bar
local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Parent = MainFrame
TitleBar.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
TitleBar.BorderSizePixel = 0
TitleBar.Size = UDim2.new(1, 0, 0, 40)

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 8)
TitleCorner.Parent = TitleBar

-- Title
local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Parent = TitleBar
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 15, 0, 0)
Title.Size = UDim2.new(0.7, 0, 1, 0)
Title.Font = Enum.Font.GothamBold
Title.Text = "Unsichtbarkeit"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18
Title.TextScaled = true
Title.TextXAlignment = Enum.TextXAlignment.Left

local TitleConstraint = Instance.new("UITextSizeConstraint")
TitleConstraint.MaxTextSize = 18
TitleConstraint.Parent = Title

-- Close Button
local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Parent = TitleBar
CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseButton.BorderSizePixel = 0
CloseButton.Position = UDim2.new(1, -35, 0.5, -12)
CloseButton.Size = UDim2.new(0, 25, 0, 25)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 16
CloseButton.TextScaled = true

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 4)
CloseCorner.Parent = CloseButton

-- Content Frame
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = MainFrame
ContentFrame.BackgroundTransparency = 1
ContentFrame.Position = UDim2.new(0, 0, 0, 45)
ContentFrame.Size = UDim2.new(1, 0, 1, -45)

-- Unsichtbar Label
local UnsichtLabel = Instance.new("TextLabel")
UnsichtLabel.Name = "UnsichtLabel"
UnsichtLabel.Parent = ContentFrame
UnsichtLabel.BackgroundTransparency = 1
UnsichtLabel.Position = UDim2.new(0, 15, 0, 20)
UnsichtLabel.Size = UDim2.new(0.5, -20, 0, 35)
UnsichtLabel.Font = Enum.Font.Gotham
UnsichtLabel.Text = "Unsichtbar:"
UnsichtLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
UnsichtLabel.TextSize = 16
UnsichtLabel.TextScaled = true
UnsichtLabel.TextXAlignment = Enum.TextXAlignment.Left

local UnsichtConstraint = Instance.new("UITextSizeConstraint")
UnsichtConstraint.MaxTextSize = 16
UnsichtConstraint.Parent = UnsichtLabel

-- Unsichtbar Status
local UnsichtStatus = Instance.new("TextLabel")
UnsichtStatus.Name = "UnsichtStatus"
UnsichtStatus.Parent = ContentFrame
UnsichtStatus.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
UnsichtStatus.BorderSizePixel = 0
UnsichtStatus.Position = UDim2.new(0.5, 5, 0, 20)
UnsichtStatus.Size = UDim2.new(0.5, -20, 0, 35)
UnsichtStatus.Font = Enum.Font.GothamBold
UnsichtStatus.Text = "OFF"
UnsichtStatus.TextColor3 = Color3.fromRGB(255, 255, 255)
UnsichtStatus.TextSize = 16
UnsichtStatus.TextScaled = true

local UnsichtStatusCorner = Instance.new("UICorner")
UnsichtStatusCorner.CornerRadius = UDim.new(0, 6)
UnsichtStatusCorner.Parent = UnsichtStatus

-- Toggle Unsichtbar Button
local ToggleUnsichtBtn = Instance.new("TextButton")
ToggleUnsichtBtn.Name = "ToggleUnsichtBtn"
ToggleUnsichtBtn.Parent = ContentFrame
ToggleUnsichtBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
ToggleUnsichtBtn.BorderSizePixel = 0
ToggleUnsichtBtn.Position = UDim2.new(0, 15, 0, 80)
ToggleUnsichtBtn.Size = UDim2.new(1, -30, 0, 35)
ToggleUnsichtBtn.Font = Enum.Font.GothamBold
ToggleUnsichtBtn.Text = "Toggle Unsichtbar"
ToggleUnsichtBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleUnsichtBtn.TextSize = 14
ToggleUnsichtBtn.TextScaled = true

local ToggleUnsichtCorner = Instance.new("UICorner")
ToggleUnsichtCorner.CornerRadius = UDim.new(0, 6)
ToggleUnsichtCorner.Parent = ToggleUnsichtBtn

-- Info Label
local InfoLabel = Instance.new("TextLabel")
InfoLabel.Name = "InfoLabel"
InfoLabel.Parent = ContentFrame
InfoLabel.BackgroundTransparency = 1
InfoLabel.Position = UDim2.new(0, 15, 0, 125)
InfoLabel.Size = UDim2.new(1, -30, 0, 25)
InfoLabel.Font = Enum.Font.Gotham
InfoLabel.Text = "Macht dich & deinen Namen unsichtbar"
InfoLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
InfoLabel.TextSize = 12
InfoLabel.TextScaled = true
InfoLabel.TextWrapped = true

local InfoConstraint = Instance.new("UITextSizeConstraint")
InfoConstraint.MaxTextSize = 12
InfoConstraint.Parent = InfoLabel

-- Variablen
local isInvisible = false
local originalName = ""
local originalTransparency = {}

-- Funktionen
local function makeCompletelyInvisible()
    local character = player.Character
    if not character then return end
    
    -- Name verstecken (mehrere Methoden)
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        originalName = humanoid.DisplayName
        humanoid.DisplayName = " "
        humanoid.HealthDisplayDistance = 0
        humanoid.NameDisplayDistance = 0
    end
    
    -- Nametag/Billboard entfernen
    local head = character:FindFirstChild("Head")
    if head then
        for _, obj in pairs(head:GetChildren()) do
            if obj:IsA("BillboardGui") then
                obj.Enabled = false
            end
        end
    end
    
    -- Alle K√∂rperteile unsichtbar machen (f√ºr andere Spieler sichtbar durch LocalTransparencyModifier)
    for _, part in pairs(character:GetChildren()) do
        if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
            originalTransparency[part] = part.Transparency
            part.Transparency = 1
            
            -- LocalTransparencyModifier f√ºr lokale Sichtbarkeit
            if part:IsA("BasePart") then
                part.LocalTransparencyModifier = 0
            end
            
            -- Face Decal verstecken
            local face = part:FindFirstChildOfClass("Decal")
            if face then
                originalTransparency[face] = face.Transparency
                face.Transparency = 1
            end
        elseif part:IsA("Accessory") then
            -- Accessoires (H√ºte, Haare, etc.) verstecken
            local handle = part:FindFirstChild("Handle")
            if handle and handle:IsA("BasePart") then
                originalTransparency[handle] = handle.Transparency
                handle.Transparency = 1
                handle.LocalTransparencyModifier = 0
            end
        end
    end
    
    -- Kleidung verstecken
    for _, clothing in pairs(character:GetChildren()) do
        if clothing:IsA("Shirt") or clothing:IsA("Pants") or clothing:IsA("ShirtGraphic") then
            clothing:Destroy()
        end
    end
    
    -- Body Colors auf unsichtbar setzen
    local bodyColors = character:FindFirstChild("Body Colors")
    if bodyColors then
        bodyColors:Destroy()
    end
end

local function makeCompletelyVisible()
    local character = player.Character
    if not character then return end
    
    -- Name wieder anzeigen (mehrere Methoden)
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        if originalName ~= "" then
            humanoid.DisplayName = originalName
        end
        humanoid.HealthDisplayDistance = 100
        humanoid.NameDisplayDistance = 100
    end
    
    -- Nametag/Billboard wieder aktivieren
    local head = character:FindFirstChild("Head")
    if head then
        for _, obj in pairs(head:GetChildren()) do
            if obj:IsA("BillboardGui") then
                obj.Enabled = true
            end
        end
    end
    
    -- Alle K√∂rperteile wieder sichtbar machen
    for part, transparency in pairs(originalTransparency) do
        if part and part.Parent then
            part.Transparency = transparency
            
            -- LocalTransparencyModifier zur√ºcksetzen
            if part:IsA("BasePart") then
                part.LocalTransparencyModifier = 1
            end
        end
    end
    
    -- Transparency-Cache leeren
    originalTransparency = {}
end

-- Toggle Unsichtbar Event
ToggleUnsichtBtn.MouseButton1Click:Connect(function()
    isInvisible = not isInvisible
    
    if isInvisible then
        makeCompletelyInvisible()
        UnsichtStatus.Text = "ON"
        UnsichtStatus.BackgroundColor3 = Color3.fromRGB(50, 200, 50)
        print("üëª Du bist jetzt unsichtbar! (Charakter + Name)")
    else
        makeCompletelyVisible()
        UnsichtStatus.Text = "OFF"
        UnsichtStatus.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
        print("‚úÖ Du bist wieder sichtbar! (Charakter + Name)")
    end
end)

-- Close Button Event
CloseButton.MouseButton1Click:Connect(function()
    if isInvisible then
        makeCompletelyVisible()
    end
    ScreenGui:Destroy()
end)

-- Hover Effekte
CloseButton.MouseEnter:Connect(function()
    CloseButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
end)

CloseButton.MouseLeave:Connect(function()
    CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
end)

ToggleNameBtn.MouseEnter:Connect(function()
    ToggleNameBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
end)

ToggleNameBtn.MouseLeave:Connect(function()
    ToggleNameBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
end)

ToggleUnsichtBtn.MouseEnter:Connect(function()
    ToggleUnsichtBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
end)

ToggleUnsichtBtn.MouseLeave:Connect(function()
    ToggleUnsichtBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
end)

-- Character Respawn Handler
player.CharacterAdded:Connect(function()
    task.wait(1)
    if isInvisible then
        makeCompletelyInvisible()
    end
end)

-- Best√§tigung
print("‚úÖ Unsichtbarkeits GUI geladen!")
print("üëª Du bist f√ºr ANDERE Spieler unsichtbar!")
print("üí° Du kannst dich selbst noch sehen (nur du!)")
print("‚ö†Ô∏è Hinweis: Funktioniert nur bei Games mit FE (Filtering Enabled)")
